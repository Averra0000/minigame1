<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Water Aim Challenge</title>
    <style>
        body { 
            margin: 0; 
            overflow: hidden; 
            background: #1a1a1a; 
            color: white; 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
        }
        canvas { display: block; }
        
        /* Progress Bars UI */
        .ui-container {
            position: absolute;
            top: 20px;
            left: 20px;
            width: 250px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            pointer-events: none; /* Let clicks pass through */
        }
        .bar-wrapper { background: rgba(0,0,0,0.5); padding: 5px; border-radius: 8px; }
        .label { font-size: 14px; font-weight: bold; margin-bottom: 4px; display: flex; justify-content: space-between; }
        .progress-bg { background: #333; height: 12px; border-radius: 6px; overflow: hidden; }
        #bar1-fill { width: 0%; height: 100%; background: #2ecc71; transition: width 0.1s; }
        #bar2-fill { width: 0%; height: 100%; background: #e74c3c; transition: width 0.1s; }
        
        .instructions {
            position: absolute;
            bottom: 20px;
            width: 100%;
            text-align: center;
            color: #888;
            font-size: 14px;
        }
    </style>
</head>
<body>

    <div class="ui-container">
        <div class="bar-wrapper">
            <div class="label"><span>SUCCESS (BAR 1)</span><span id="p1">0%</span></div>
            <div class="progress-bg"><div id="bar1-fill"></div></div>
        </div>
        <div class="bar-wrapper">
            <div class="label"><span>FAILURE (BAR 2)</span><span id="p2">0%</span></div>
            <div class="progress-bg"><div id="bar2-fill"></div></div>
        </div>
    </div>

    <div class="instructions">Use MOUSE or ARROW KEYS to control the water landing point.</div>

    <canvas id="gameCanvas"></canvas>

<script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    
    // Game Config
    let bar1 = 0;
    let bar2 = 0;
    const bar1Rate = 10; // 10% per second
    const bar2Rate = 30; // 30% per second
    let lastTime = 0;
    let isGameOver = false;

    // Water Position & Physics
    let waterPos = { x: window.innerWidth/2, y: window.innerHeight/2 };
    let drift = { x: 0, y: 0 };
    const keys = {};

    // Target Zone (Center)
    const targetSize = { w: 200, h: 200 };

    function resize() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resize);
    resize();

    // Input Listeners
    window.addEventListener('keydown', e => keys[e.key] = true);
    window.addEventListener('keyup', e => keys[e.key] = false);
    window.addEventListener('mousemove', e => {
        // Influence water position with mouse (gentle pull)
        waterPos.x += (e.clientX - waterPos.x) * 0.1;
        waterPos.y += (e.clientY - waterPos.y) * 0.1;
    });

    function update(timestamp) {
        if (isGameOver) return;
        
        const dt = (timestamp - lastTime) / 1000;
        lastTime = timestamp;
        if (!dt) { requestAnimationFrame(update); return; }

        // 1. Random Drift (The "Water" feel)
        drift.x += (Math.random() - 0.5) * 2;
        drift.y += (Math.random() - 0.5) * 2;
        waterPos.x += drift.x;
        waterPos.y += drift.y;
        drift.x *= 0.95; // Friction
        drift.y *= 0.95;

        // 2. Keyboard Control
        const speed = 300 * dt;
        if (keys['ArrowUp'] || keys['w']) waterPos.y -= speed;
        if (keys['ArrowDown'] || keys['s']) waterPos.y += speed;
        if (keys['ArrowLeft'] || keys['a']) waterPos.x -= speed;
        if (keys['ArrowRight'] || keys['d']) waterPos.x += speed;

        // 3. Keep in screen
        waterPos.x = Math.max(0, Math.min(canvas.width, waterPos.x));
        waterPos.y = Math.max(0, Math.min(canvas.height, waterPos.y));

        // 4. Scoring Logic
        const targetX = (canvas.width - targetSize.w) / 2;
        const targetY = (canvas.height - targetSize.h) / 2;
        
        const inTarget = waterPos.x > targetX && waterPos.x < targetX + targetSize.w &&
                         waterPos.y > targetY && waterPos.y < targetY + targetSize.h;

        if (inTarget) {
            bar1 += bar1Rate * dt;
        } else {
            bar2 += bar2Rate * dt;
        }

        // Update UI
        document.getElementById('bar1-fill').style.width = Math.min(bar1, 100) + '%';
        document.getElementById('bar2-fill').style.width = Math.min(bar2, 100) + '%';
        document.getElementById('p1').innerText = Math.floor(bar1) + '%';
        document.getElementById('p2').innerText = Math.floor(bar2) + '%';

        // 5. Win/Loss Check
        if (bar1 >= 100) {
            isGameOver = true;
            alert("YOU WIN! Perfect Aim.");
            location.reload();
        } else if (bar2 >= 100) {
            isGameOver = true;
            alert("GAME OVER! You missed too much.");
            location.reload();
        }

        draw();
        requestAnimationFrame(update);
    }

    function draw() {
        ctx.fillStyle = '#1a1a1a';
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        const targetX = (canvas.width - targetSize.w) / 2;
        const targetY = (canvas.height - targetSize.h) / 2;

        // Draw Target Zone
        ctx.strokeStyle = '#2ecc71';
        ctx.lineWidth = 2;
        ctx.strokeRect(targetX, targetY, targetSize.w, targetSize.h);
        ctx.fillStyle = 'rgba(46, 204, 113, 0.1)';
        ctx.fillRect(targetX, targetY, targetSize.w, targetSize.h);

        // Draw Water Drop (The Aim Point)
        ctx.beginPath();
        const gradient = ctx.createRadialGradient(waterPos.x, waterPos.y, 0, waterPos.x, waterPos.y, 20);
        gradient.addColorStop(0, '#00d4ff');
        gradient.addColorStop(1, 'transparent');
        ctx.fillStyle = gradient;
        ctx.arc(waterPos.x, waterPos.y, 20, 0, Math.PI * 2);
        ctx.fill();

        // Draw "Splatter" effect
        ctx.fillStyle = '#00d4ff';
        ctx.beginPath();
        ctx.arc(waterPos.x, waterPos.y, 5, 0, Math.PI * 2);
        ctx.fill();
    }

    requestAnimationFrame(update);
</script>
</body>
</html>
